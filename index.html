<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contextsheet - AI for Google Sheets</title>
    <meta
      name="description"
      content="Contextsheet brings the power of large language models (Gemini, Claude, ChatGPT) and Google Drive context directly into your Google Sheets."
    />
    <link rel="icon" href="images/logo_small.png" type="image/png" />
    <style>
      /* Reset & Base */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; /* Sans-serif for body */
        line-height: 1.6;
        color: #333;
        background-color: #ffffff; /* White background */
        padding-top: 80px; /* Space for fixed header */
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      .container {
        max-width: 1100px; /* Wider container for grid */
        margin: 20px auto; /* Add top margin */
        padding: 0 20px; /* Padding on sides */
        flex-grow: 1;
        width: 100%;
      }

      /* Consistent Section Padding */
      #home-content > div,
      #about-content > div,
      #about-content > h2,
      #about-content > p,
      #about-content > ul,
      #about-content > a.button {
        max-width: 800px; /* Consistent max-width like about page */
        margin-left: auto;
        margin-right: auto;
      }

      /* Adjust padding for specific home sections */
      #home-content > .split-showcase {
        max-width: 1100px; /* Allow showcase to be wider */
      }
      #home-content > .how-it-works,
      #home-content > .upcoming-features-static,
      #home-content > .feature-details {
        padding: 30px 0;
        max-width: 800px; /* Apply max-width */
        text-align: left; /* Align content left */
      }

      #home-content > .feature-details {
        padding-top: 0; /* Remove extra padding */
      }

      /* Header */
      header {
        background-color: #ffffff;
        border-bottom: 1px solid #eee;
        position: fixed; /* Fixed header */
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        padding: 15px 0;
      }

      nav {
        max-width: 1100px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 50px; /* Fixed height for alignment */
      }

      .nav-left ul {
        list-style: none;
        display: flex;
        gap: 25px; /* Increased gap */
      }

      .nav-left a {
        text-decoration: none;
        color: #555;
        font-size: 0.95em;
        letter-spacing: 0.5px;
        padding-bottom: 3px;
        border-bottom: 2px solid transparent;
        transition: color 0.2s ease, border-color 0.2s ease;
      }

      .nav-left a:hover,
      .nav-left a.active {
        color: #000;
        border-bottom-color: #aaa;
      }

      .nav-center {
        font-family: "Times New Roman", Times, serif; /* Serif font for title */
        color: #222;
        position: absolute; /* Center absolutely */
        left: 50%;
        transform: translateX(-50%);
        height: 100%; /* Take full nav height */
        display: flex; /* Use flex to center image */
        align-items: center;
        justify-content: center;
      }
      .nav-center a {
        /* Style the link containing the image */
        color: inherit;
        text-decoration: none;
        height: 80%; /* Increased from 60% to make logo larger */
        display: flex; /* Align image within link */
        align-items: center;
      }
      .nav-center img {
        height: 100%; /* Make image fill link height */
        width: auto; /* Maintain aspect ratio */
      }

      /* Main Content Sections */
      main section {
        padding: 20px 0; /* Padding top/bottom */
      }

      /* Home Page Specifics */
      #home-content h1 {
        text-align: center;
        font-family: "Times New Roman", Times, serif;
        font-weight: normal;
        font-size: 1.5em;
        margin-bottom: 30px;
        color: #444;
      }
      #home-content > p {
        /* Style the intro paragraph */
        text-align: center;
        max-width: 700px;
        margin: 0 auto 40px auto; /* Center block and add bottom margin */
        color: #555;
        font-size: 1.05em;
      }

      @media (max-width: 768px) {
        .nav-center img {
          max-height: 40px;
          width: auto;
        }
      }

      @media (max-width: 768px) {
        /* logo */
        .nav-center img {
          max-height: 40px;
          width: auto;
        }

        /* all other images (screenshots, carousel, about‚Äëme, etc) */
        main img,
        .about-me-carousel img {
          max-height: 250px;
          width: auto;
        }
      }

      /* Split Showcase (Replaces Media Carousel) */
      .split-showcase {
        display: flex;
        justify-content: center; /* Center the showcase */
        margin: 0 auto 40px auto;
        max-width: 1100px; /* Adjust max-width if needed */
      }

      .video-showcase {
        position: relative;
        height: 450px;
        display: flex;
        flex-direction: column;
        width: 100%;
        max-width: 800px; /* Max width to prevent videos from getting too large */
      }

      .video-carousel-container {
        flex-grow: 1;
        width: 100%;
        height: 400px;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
      }

      .video-track {
        display: flex;
        align-items: center;
        height: 100%;
        width: 100%;
        position: relative;
      }

      .video-track .media-item {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.6s ease-in-out;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .video-track .media-item.active {
        opacity: 1;
        visibility: visible;
        z-index: 1;
      }

      .video-track .media-item video {
        width: 100%;
        max-width: 100%;
        height: auto;
        max-height: 100%;
        box-sizing: border-box;
      }

      .video-showcase .caption {
        font-family: "Times New Roman", Times, serif;
        font-size: 1em;
        color: #444;
        text-decoration: underline;
        text-decoration-thickness: 1px;
        text-underline-offset: 3px;
        text-align: center;
        width: 100%;
        flex-shrink: 0;
      }

      .video-showcase .caption.video-caption {
        position: relative;
        margin-top: 10px;
        text-align: center;
        z-index: 10;
      }

      /* Reposition Carousel Navigation Arrows */
      .carousel-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-60%);
        background-color: rgba(0, 0, 0, 0.4);
        color: white;
        border: none;
        border-radius: 50%;
        width: 35px; /* Slightly smaller arrows */
        height: 35px;
        font-size: 18px;
        cursor: pointer;
        z-index: 5;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s ease;
        /* Position relative to showcase-right which is the flex item */
      }
      .carousel-btn:hover {
        background-color: rgba(0, 0, 0, 0.7);
      }
      /* Position arrows relative to showcase-right */
      .video-carousel-container .carousel-btn.prev-btn {
        left: 20px;
      }
      .video-carousel-container .carousel-btn.next-btn {
        right: 20px;
      }

      /* About Page Specifics */
      #about-content {
        max-width: 800px; /* Narrower content for text */
        margin: 0 auto; /* Center the about content */
      }

      #about-content h1,
      #about-content h2 {
        font-family: "Times New Roman", Times, serif;
        font-weight: normal;
        color: #333;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
        margin-bottom: 15px;
        margin-top: 30px;
      }
      #about-content h1 {
        font-size: 1.8em;
        text-align: center;
        border-bottom: none; /* No border for main H1 */
        margin-bottom: 25px;
      }
      #about-content h2 {
        font-size: 1.4em;
        margin-top: 40px;
      }

      #about-content p,
      #about-content ul {
        margin-bottom: 15px;
        color: #555;
        font-size: 0.95em;
      }
      #about-content ul {
        margin-left: 20px;
        list-style: disc; /* Use standard bullets */
      }
      #about-content li {
        margin-bottom: 8px;
      }
      #about-content strong {
        color: #111; /* Make strong text darker */
        font-weight: 600;
      }
      #about-content a {
        /* Style links within about page */
        color: black; /* Standard link blue */
        text-decoration: none;
      }
      #about-content a:hover {
        text-decoration: underline;
      }

      /* About Intro Layout */
      .about-intro {
        display: flex;
        gap: 30px; /* Space between carousel and text */
        align-items: center; /* Vertically align items */
        margin-bottom: 25px; /* Space below the intro block */
      }

      .about-me-carousel {
        width: 150px; /* Fixed width for the carousel */
        height: 150px;
        flex-shrink: 0; /* Prevent carousel from shrinking */
        position: relative;
        overflow: hidden;
        border-radius: 50%; /* Make it circular */
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
      }

      .about-me-carousel .carousel-item {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.8s ease-in-out; /* Smooth fade */
      }

      .about-me-carousel .carousel-item.active {
        opacity: 1;
        visibility: visible;
      }

      .about-me-carousel img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover; /* Ensure image covers the circle */
      }

      .about-intro-text {
        flex-grow: 1; /* Allow text to take remaining space */
      }

      /* Connect List Icons */
      #about-content .connect-list li {
        display: flex;
        align-items: center; /* Vertically align icon and text */
        gap: 8px; /* Space between icon and text */
        margin-bottom: 10px; /* Space between list items */
      }
      #about-content .connect-list img.icon {
        width: 20px; /* Set icon size */
        height: 20px;
        flex-shrink: 0; /* Prevent icon from shrinking */
      }

      /* Buttons (Keep for About page, slightly simplified) */
      .button {
        display: inline-block;
        background-color: #1877f2; /* Brighter Blue */
        color: #ffffff;
        padding: 10px 25px; /* Slightly larger padding */
        text-decoration: none;
        border-radius: 6px; /* More rounded corners */
        font-weight: 500; /* Medium weight (or try 600 for bolder) */
        font-size: 0.95em; /* Slightly larger text */
        letter-spacing: 0.5px; /* Add slight letter spacing */
        transition: background-color 0.2s ease;
        border: none;
        cursor: pointer;
        margin-right: 10px;
        margin-top: 10px;
      }
      .button:hover {
        background-color: #166fe5; /* Darker shade of the brighter blue */
      }
      .button.secondary {
        background-color: #f0f0f0; /* Light grey */
        color: #333;
        border: 1px solid #ddd;
      }
      .button.secondary:hover {
        background-color: #e0e0e0;
      }

      /* Footer */
      footer {
        text-align: center;
        margin-top: 50px; /* More space above footer */
        padding: 25px 20px;
        font-size: 0.85em;
        color: #888; /* Lighter footer text */
        border-top: 1px solid #eee;
        background-color: #ffffff;
      }
      footer a {
        color: #666; /* Slightly darker link */
        text-decoration: none;
      }
      footer a:hover {
        text-decoration: underline;
      }

      /* Utility */
      .hidden {
        display: none !important; /* Add !important */
      }

      /* How it Works Section */
      .how-it-works {
        padding: 30px 0;
        margin-top: 40px;
        max-width: 800px;
        text-align: left; /* Ensure left alignment */
      }

      .how-it-works h2 {
        text-align: left; /* Explicitly set left alignment for the h2 */
        margin-bottom: 25px;
      }

      /* Reset any conflicting styles that might center the text */
      #home-content .how-it-works {
        text-align: left;
      }

      #home-content .how-it-works h2 {
        text-align: left;
      }

      @media (max-width: 768px) {
        #home-content {
          display: flex;
          flex-direction: column;
        }

        /* 1. intro text */
        #home-content > p {
          order: 0;
        }

        /* 2. split showcase (video + carousel) */
        #home-content > .split-showcase {
          order: 1;
        }

        /* 3. feature explanations */
        #home-content > .feature-details {
          order: 4;
        }

        /* 4. how‚Äëit‚Äëworks */
        #home-content > .how-it-works {
          order: 2;
        }

        /* 5. roadmap */
        #home-content > .upcoming-features-static {
          order: 3;
        }

        .how-it-works {
          margin-top: 10px;
          padding-top: 10px;
        }

        .split-showcase {
          margin-bottom: 20px;
          padding: 0 10px;
        }

        .video-showcase {
          height: auto;
          min-height: 250px;
          max-height: none;
          margin-bottom: 40px;
        }

        .video-carousel-container {
          height: auto;
          min-height: 200px;
          width: 100%;
        }

        .video-track .media-item {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        }

        .video-track .media-item video {
          width: 100%;
          height: auto;
        }

        .carousel-btn {
          width: 40px;
          height: 40px;
          font-size: 22px;
          opacity: 0.7;
        }

        .video-caption {
          margin-top: 15px;
          font-size: 1.1em;
        }

        /* How it Works on smaller screens */
        .how-it-works .steps-list {
          flex-direction: column; /* Stack steps vertically */
          align-items: center; /* Center items when stacked */
          gap: 15px; /* Adjust gap for column layout */
        }
        .how-it-works .steps-list li {
          flex-basis: auto; /* Reset basis */
          width: 80%; /* Adjust width */
          max-width: 400px; /* Max width for readability */
        }
      }

      @media (max-width: 480px) {
        body {
          font-size: 15px; /* Slightly smaller base font */
        }
        .nav-center {
          font-size: 1.4em;
        }
        .nav-left a {
          font-size: 0.9em;
        }
        #home-content h1 {
          font-size: 1.3em;
        }
        #home-content > p {
          font-size: 1em;
          padding: 0 15px;
        }
        #about-content h1 {
          font-size: 1.6em;
        }
        #about-content h2 {
          font-size: 1.2em;
        }

        .video-showcase {
          min-height: 220px;
        }

        .video-carousel-container {
          min-height: 180px;
        }

        .video-track .media-item {
          min-height: 180px;
        }

        .carousel-btn {
          width: 38px;
          height: 38px;
          font-size: 20px;
        }

        .video-caption {
          margin-top: 12px;
          font-size: 1em;
        }

        /* How it Works on smallest screens */
        .how-it-works .steps-list li {
          width: 95%; /* Take more width on very small screens */
          font-size: 0.95em;
        }
        .how-it-works .steps-list li span {
          font-size: 1.4em;
        }
      }

      @media (max-width: 768px) {
        .video-carousel-container,
        .video-showcase .caption {
          display: block; /* Changed from none to block to show the video carousel on mobile */
        }
      }

      .how-it-works .steps-list,
      .upcoming-features-static .roadmap-list {
        list-style: none;
        padding: 0;
      }

      /* How it Works Section Styling (Keep existing flex layout) */
      .how-it-works .steps-list {
        display: inline-flex;
        flex-wrap: wrap;
        gap: 20px 30px;
        justify-content: center;
        max-width: 900px;
        margin: 0 auto;
      }

      .how-it-works .steps-list li {
        font-size: 1em;
        color: #555;
        display: flex;
        align-items: center;
        gap: 10px;
        text-align: left;
        min-width: 200px;
        flex-basis: calc(50% - 15px);
      }

      .how-it-works .steps-list li span {
        font-size: 1.5em;
        flex-shrink: 0;
      }

      /* Upcoming Features Section Styling (Keep existing flex layout) */
      .upcoming-features-static .roadmap-list {
        display: inline-flex;
        flex-wrap: wrap;
        gap: 15px 30px;
        justify-content: center;
        max-width: 800px;
        margin: 0 auto;
      }

      .upcoming-features-static .roadmap-list li {
        font-size: 1em;
        color: #555;
        text-align: center;
      }

      .upcoming-features-static .roadmap-list li i {
        margin-right: 8px;
        font-style: normal;
      }

      /* Feature Details Section */
      .feature-details {
        /* margin-top: 40px; Removed */
        /* padding-top: 20px; Removed */
        /* border-top: 1px solid #eee; Removed */
      }

      .feature-explanation {
        margin-bottom: 40px;
      }

      .feature-explanation h3 {
        font-family: "Times New Roman", Times, serif;
        font-weight: normal;
        color: #333;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
        margin-bottom: 15px;
      }

      .feature-explanation p {
        margin-bottom: 15px;
        color: #555;
        font-size: 0.95em;
      }

      @media (max-width: 768px) {
        #home-content > .split-showcase {
          /* Ensures the container for the showcase is centered */
          display: flex;
          justify-content: center;
          padding-left: 10px;
          padding-right: 10px;
          box-sizing: border-box; /* Include padding in width calculation */
        }

        .video-showcase {
          min-height: 300px;
          margin-bottom: 50px;
          width: 100%; /* Ensure showcase takes full width within padded parent */
          box-sizing: border-box;
          display: flex; /* Ensure flex properties for alignment */
          flex-direction: column;
        }

        .video-carousel-container {
          flex-grow: 1; /* Allow container to take available height */
          min-height: 280px;
          width: 100%;
          box-sizing: border-box;
          position: relative; /* Needed for absolute children */
          display: flex; /* Center the track */
          align-items: center;
          justify-content: center;
        }

        .video-track {
          width: 100%;
          height: 100%;
          position: relative;
        }

        .video-track .media-item {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          display: flex; /* Use flex to center video inside */
          justify-content: center;
          align-items: center;
          opacity: 0;
          visibility: hidden;
          transition: opacity 0.6s ease-in-out;
        }

        .video-track .media-item.active {
          opacity: 1;
          visibility: visible;
        }

        .video-track .media-item video {
          display: block; /* Ensure it's a block element */
          width: auto; /* Let width adjust based on height */
          height: auto; /* Let height adjust based on width */
          max-width: 100%; /* Limit width to container */
          max-height: 100%; /* Limit height to container */
          object-fit: contain; /* Maintain aspect ratio, fit within bounds */
          box-sizing: border-box;
        }

        .carousel-btn {
          transform: translateY(-50%);
        }

        .carousel-btn.prev-btn {
          left: 5px;
        }
        .carousel-btn.next-btn {
          right: 5px;
        }
        /* ... other styles ... */
      }

      @media (max-width: 480px) {
        /* ... other styles ... */
        #home-content > .split-showcase {
          padding-left: 5px; /* Less padding on very small screens */
          padding-right: 5px;
        }

        .video-showcase {
          min-height: 250px;
        }

        .video-carousel-container {
          min-height: 230px;
        }

        .video-track .media-item video {
          max-height: 85%;
        }

        .carousel-btn.prev-btn {
          left: 2px;
        }
        .carousel-btn.next-btn {
          right: 2px;
        }
        /* ... other styles ... */
      }

      /* Consistent H2 Styling */
      #home-content h2,
      #about-content h2 {
        font-family: "Times New Roman", Times, serif;
        font-weight: normal;
        color: #333;
        border-bottom: 1px solid #eee; /* Keep bottom border */
        padding-bottom: 5px;
        margin-bottom: 25px; /* Increased spacing */
        margin-top: 40px;
        font-size: 1.4em;
        text-align: left; /* Align left */
      }

      /* Remove conflicting H2 styles */
      #about-content h1 + h2, /* First H2 on about page */
      #home-content .how-it-works h2,
      #home-content .upcoming-features-static h2,
      #home-content .feature-details h2 {
        margin-top: 0; /* Remove top margin if it directly follows another element */
        text-align: left;
        font-size: 1.4em; /* Ensure consistent size */
        /* Remove other specific styles if needed */
      }
      #home-content .feature-details h2 {
        text-align: left; /* Override center */
        margin-bottom: 25px; /* Consistent margin */
      }

      #about-content h1 {
        font-size: 1.8em;
        text-align: center;
        border-bottom: none; /* No border for main H1 */
        margin-bottom: 25px;
        margin-top: 0; /* Align with container top */
        max-width: 800px; /* Consistent max-width */
        margin-left: auto;
        margin-right: auto;
      }

      /* Consistent Paragraph and List Styling */
      #home-content p,
      #home-content ul,
      #about-content p,
      #about-content ul {
        margin-bottom: 15px;
        color: #555;
        font-size: 0.95em;
        line-height: 1.7; /* Consistent line height */
      }
      #home-content ul,
      #about-content ul {
        margin-left: 20px;
        list-style: disc; /* Use standard bullets where applicable */
      }
      #home-content .steps-list,
      #home-content .roadmap-list {
        list-style: none; /* Keep these lists unstyled */
        margin-left: 0; /* Remove indent */
        padding: 0; /* Remove padding */
        max-width: 100%; /* Allow flex items to space out */
      }
      #about-content li {
        /* Keep specific about list item margin */
        margin-bottom: 8px;
      }
      #home-content strong,
      #about-content strong {
        color: #111; /* Make strong text darker */
        font-weight: 600;
      }
      #home-content a,
      #about-content a:not(.button) {
        /* Style links excluding buttons */
        color: white;
        text-decoration: none;
      }
      #home-content a:hover,
      #about-content a:not(.button):hover {
        text-decoration: underline;
      }

      /* Consistent H3 Styling (using Feature Explanation style) */
      #home-content h3,
      #about-content h3 {
        /* Apply to any potential H3 in about */
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-weight: 500;
        font-size: 1.1em;
        color: #444;
        margin-bottom: 15px; /* Consistent margin */
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
        text-align: left; /* Align left */
        margin-top: 40px; /* Add spacing above H3 */
      }

      #home-content .feature-explanation {
        margin-bottom: 30px;
        padding-top: 0; /* Remove anchor offset padding */
        margin-top: 0; /* Remove anchor offset margin */
      }
      #home-content .feature-explanation h3 {
        margin-top: 0; /* No top margin for these specific h3 */
      }

      /* Static Upcoming Features Section */
      .upcoming-features-static {
        /* margin-top: 60px; Removed */
        /* padding: 30px 0; Removed */
        /* border-top: 1px solid #eee; Removed */
        /* text-align: center; Removed */
      }
      .upcoming-features-static p {
        margin-top: 20px;
        font-size: 0.9em; /* Slightly smaller email text */
        text-align: center; /* Center the email text */
      }

      /* Feature Details Section */
      .feature-details {
        /* margin-top: 40px; Removed */
        /* padding-top: 20px; Removed */
        /* border-top: 1px solid #eee; Removed */
      }

      /* Feature Explanation */
      .feature-explanation p {
        color: #555;
        line-height: 1.7;
        /* Removed other specific styles, now use general p style */
      }

      @media (max-width: 768px) {
        /* ... other styles ... */
        #home-content > div,
        #about-content > div,
        #about-content > h2,
        #about-content > p,
        #about-content > ul,
        #about-content > a.button {
          max-width: 100%; /* Remove max-width on mobile */
          padding-left: 15px; /* Add consistent padding */
          padding-right: 15px;
        }

        #home-content > .split-showcase {
          max-width: 100%; /* Remove max-width */
          padding-left: 10px; /* Keep slightly less for showcase */
          padding-right: 10px;
        }

        #home-content h2,
        #about-content h2 {
          padding-left: 0; /* Remove specific padding for headers */
          padding-right: 0;
          margin-left: 15px; /* Use margin instead */
          margin-right: 15px;
        }

        #about-content h1 {
          padding-left: 15px;
          padding-right: 15px;
        }

        #home-content ul,
        #about-content ul {
          margin-left: 35px; /* Keep indent relative to padding */
        }
        #home-content .steps-list,
        #home-content .roadmap-list {
          margin-left: 15px; /* Adjust padding/margin */
          padding-left: 0;
          padding-right: 15px;
          align-items: flex-start; /* Ensure left alignment */
        }
      }

      @media (max-width: 480px) {
        /* ... other styles ... */
        #home-content h2,
        #about-content h2 {
          font-size: 1.3em; /* Slightly smaller h2 */
        }
        #home-content h3,
        #about-content h3 {
          font-size: 1.2em; /* Slightly smaller h3 */
        }
        #home-content p,
        #home-content ul,
        #about-content p,
        #about-content ul {
          font-size: 0.9em; /* Slightly smaller text */
        }
        #home-content > div,
        #about-content > div,
        #about-content > h2,
        #about-content > p,
        #about-content > ul,
        #about-content > a.button {
          padding-left: 10px;
          padding-right: 10px;
        }
        #home-content h2,
        #about-content h2 {
          margin-left: 10px;
          margin-right: 10px;
        }
        #home-content ul,
        #about-content ul {
          margin-left: 30px;
        }
        #home-content .steps-list,
        #home-content .roadmap-list {
          margin-left: 10px;
          padding-right: 10px;
        }
      }

      /* Video Player Styles */
      #simple-video-player {
        position: relative;
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 450px;
        background-color: transparent;
        overflow: hidden;
      }

      #main-video {
        width: 100%;
        max-height: 450px;
        display: block;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border: none;
        border-radius: 0;
        object-fit: contain;
        background-color: transparent;
      }

      .video-controls {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
        box-sizing: border-box;
        pointer-events: none; /* Allow clicks to pass through to the video */
      }

      .video-btn {
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 22px;
        cursor: pointer;
        z-index: 5;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s ease;
        pointer-events: auto; /* Make buttons clickable */
      }

      .video-btn:hover {
        background-color: rgba(0, 0, 0, 0.8);
      }

      .video-caption {
        text-align: center;
        margin-top: 15px;
        font-family: "Times New Roman", Times, serif;
        font-size: 1.1em;
        color: #444;
        text-decoration: underline;
        text-decoration-thickness: 1px;
        text-underline-offset: 3px;
      }

      .video-showcase {
        position: relative;
        width: 100%;
        max-width: 800px;
        margin: 0 auto 20px auto;
      }

      /* Mobile adjustments */
      @media (max-width: 768px) {
        #simple-video-player {
          min-height: 300px;
        }

        #main-video {
          max-height: 300px;
        }

        .video-btn {
          width: 40px;
          height: 40px;
          font-size: 18px;
        }
      }

      @media (max-width: 480px) {
        #simple-video-player {
          min-height: 250px;
        }

        #main-video {
          max-height: 250px;
        }

        .video-btn {
          width: 36px;
          height: 36px;
          font-size: 16px;
        }
      }

      /* Remove any white backgrounds from video containers */
      .video-showcase,
      .split-showcase,
      #simple-video-player,
      #main-video,
      .video-track,
      .media-item {
        background-color: transparent !important;
      }

      /* Style the Privacy Policy section like the About section */
      #privacy-content {
        max-width: 800px; /* Consistent max-width */
        margin: 0 auto; /* Center the content */
      }
      #privacy-content h1,
      #privacy-content h2 {
        font-family: "Times New Roman", Times, serif;
        font-weight: normal;
        color: #333;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
        margin-bottom: 15px;
        margin-top: 30px;
      }
      #privacy-content h1 {
        font-size: 1.8em;
        text-align: center;
        border-bottom: none;
        margin-bottom: 25px;
        margin-top: 0; /* Align with container top */
      }
      #privacy-content h2 {
        font-size: 1.4em;
        text-align: left;
      }
      #privacy-content p,
      #privacy-content ul {
        margin-bottom: 15px;
        color: #555;
        font-size: 0.95em;
        line-height: 1.7; /* Consistent line height */
      }
      #privacy-content ul {
        margin-left: 20px;
        list-style: disc;
      }
      #privacy-content ul ul {
        /* Style nested lists */
        margin-top: 5px;
        margin-left: 25px; /* Further indent */
        list-style: circle; /* Different bullet */
      }
      #privacy-content li {
        margin-bottom: 8px;
      }
      #privacy-content strong {
        color: #111;
        font-weight: 600;
      }
      #privacy-content a {
        color: black;
        text-decoration: none;
      }
      #privacy-content a:hover {
        text-decoration: underline;
      }

      /* Mobile adjustments for Privacy Policy */
      @media (max-width: 768px) {
        #privacy-content {
          max-width: 100%; /* Remove max-width on mobile */
          padding-left: 15px; /* Add consistent padding */
          padding-right: 15px;
        }
        #privacy-content h1,
        #privacy-content h2 {
          margin-left: 0;
          margin-right: 0;
        }
        #privacy-content ul {
          margin-left: 25px; /* Adjust indent */
        }
        #privacy-content ul ul {
          margin-left: 30px;
        }
      }
      @media (max-width: 480px) {
        #privacy-content p,
        #privacy-content ul {
          font-size: 0.9em; /* Slightly smaller text */
        }
        #privacy-content h1 {
          font-size: 1.6em;
        }
        #privacy-content h2 {
          font-size: 1.2em;
        }
        #privacy-content ul {
          margin-left: 20px; /* Adjust indent */
        }
        #privacy-content ul ul {
          margin-left: 25px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <div class="nav-left">
          <ul>
            <li>
              <a href="#" id="nav-home" class="nav-link active">Home</a>
            </li>
            <li>
              <a href="#" id="nav-about" class="nav-link">About</a>
            </li>
          </ul>
        </div>
        <div class="nav-center">
          <a href="#" onclick="showPage('home-content'); return false;">
            <img src="images/logo.png" alt="Contextsheet Logo" />
          </a>
        </div>
        <!-- Right navigation can be added here if needed -->
      </nav>
    </header>

    <main class="container">
      <!-- Home Page Content -->
      <section id="home-content">
        <!-- Removed H1 from here, using centered paragraph -->
        <p>
          Contextsheet is a free and privacy friendly Google Sheets‚Ñ¢ extension
          connecting spreadsheets to LLMs (Gemini, Claude, ChatGPT) and Google
          Drive‚Ñ¢ for contextual answers, without ever leaving your Google
          environment (besides the LLM endpoints).
        </p>

        <!-- Replaced media-carousel with split-showcase -->
        <div class="split-showcase">
          <div class="video-showcase">
            <div id="simple-video-player">
              <video id="main-video" controls autoplay muted playsinline>
                <source
                  src="images/demo.mp4"
                  type="video/mp4"
                  id="video-source"
                />
                Your browser does not support the video tag.
              </video>
              <!-- Navigation Controls -->
              <div class="video-controls">
                <button class="video-btn prev-btn" aria-label="Previous Video">
                  &#10094;
                </button>
                <button class="video-btn next-btn" aria-label="Next Video">
                  &#10095;
                </button>
              </div>
            </div>
            <div class="video-caption">Demo Video</div>
          </div>
        </div>

        <!-- How it Works Section -->
        <div class="how-it-works">
          <h2>How it Works (4 Simple Steps)</h2>
          <ul class="steps-list">
            <li>
              <span>üîó</span> 1. Insert URL to Drive folder / file for context.
            </li>
            <li>
              <span>‚ùì</span> 2. Select cells and ask a question about them.
            </li>
            <li><span>‚è≥</span> 3. Wait.</li>
            <li>
              <span>ü•≥</span> 4. Check responses and insert into your sheet.
            </li>
          </ul>
          <div style="text-align: center; margin-top: 30px">
            <a
              href="[YOUR_GOOGLE_WORKSPACE_MARKETPLACE_LINK_HERE]"
              target="_blank"
              rel="noopener noreferrer"
              class="button"
              >Get started</a
            >
          </div>
        </div>

        <!-- Static Upcoming Features Section -->
        <div class="upcoming-features-static">
          <h2>Future Roadmap</h2>
          <ul class="roadmap-list">
            <li>
              <i>üññ</i> Save tokens by combining queries using same documents as
              context
            </li>
            <li><i>üîç</i> OCR Scanning for scanned PDFs (Google vision)</li>
            <li><i>üîó</i> Better sourcing of context in snippets</li>
            <li><i>üê¢</i> Slower answers as a workaround quota limits</li>
            <!-- Add more planned features -->
          </ul>
          <p style="margin-top: 20px; font-size: 0.95em">
            Have suggestions for new features or found a bug? Email me at
            albert.steenstrup@contextsheet.com
          </p>
        </div>

        <!-- Feature Details Section -->
        <div class="feature-details">
          <h2>Feature Explanations</h2>

          <div id="details-main-interface" class="feature-explanation">
            <h3>Main Interface</h3>
            <p>
              This shows the primary Contextsheet sidebar view. Here, you can
              select your preferred AI model (like Gemini, Claude, or ChatGPT)
              from the dropdown, manage the API keys for each service via the
              tabs, and set the core context source using a Google Drive file or
              folder URL. Buttons for accessing Options and Advanced Settings
              are also visible.
            </p>
            <!-- Add more detail -->
          </div>

          <div id="details-loading-response" class="feature-explanation">
            <h3>Loading Response</h3>
            <p>
              While processing your queries, the sidebar shows a loading state.
              It indicates how many non-empty cells were found in your selection
              and displays placeholders while preparing context and fetching
              answers from the AI model for each query.
            </p>
            <!-- Add more detail -->
          </div>

          <div id="details-example-response" class="feature-explanation">
            <h3>Example Response</h3>
            <p>
              Here's how Contextsheet displays results after processing queries.
              Each card corresponds to a cell query (e.g., "Age of Alice"). It
              shows the relevant text snippet extracted from the context
              document (if enabled in options), along with the final answer
              generated by the AI. You can select results to insert back into
              your sheet.
            </p>
            <!-- Add more detail -->
          </div>

          <div id="details-options" class="feature-explanation">
            <h3>Options</h3>
            <p>
              The Options panel allows basic configuration. You can set the
              required Google Drive URL for context, toggle whether to include
              the context snippet in the result display, and choose whether to
              list the context documents used when inserting answers back into
              the sheet. Access to Advanced Settings is also provided.
            </p>
            <!-- Add more detail -->
          </div>

          <div id="details-advanced-options" class="feature-explanation">
            <h3>Advanced Options</h3>
            <p>
              Dive deeper into customization with Advanced Settings. Control the
              preference for recent files when ranking search results. Adjust
              the Search Focus slider to prioritize document titles versus their
              full content. Modify the Context Strategy slider to favour finding
              answers in smaller text snippets versus reflecting upon whole
              documents. An upcoming PDF OCR feature is also hinted;)
            </p>
            <!-- Add more detail -->
          </div>

          <div id="details-settings-panel" class="feature-explanation">
            <h3>Settings Panel</h3>
            <p>
              The main Settings panel is the hub for core configuration. Select
              the AI model (LLM) you want to use from the dropdown menu. Use the
              tabs (Gemini, Claude, ChatGPT) to securely enter and manage your
              API keys for each respective service. Direct links to obtain keys
              and manage settings are provided here as well.
            </p>
            <!-- Add more detail -->
          </div>
        </div>
      </section>

      <!-- About Page Content -->
      <section id="about-content" class="hidden">
        <h1>About Contextsheet</h1>
        <div class="about-intro">
          <div class="about-me-carousel">
            <div class="carousel-item active">
              <img src="images/me1.png" alt="About Me Image 1" />
            </div>
            <div class="carousel-item">
              <img src="images/me2.png" alt="About Me Image 2" />
            </div>
            <div class="carousel-item">
              <img src="images/me3.png" alt="About Me Image 3" />
            </div>
          </div>
          <div class="about-intro-text">
            <p>Hi! I'm Albert, I created Contextsheet.</p>
          </div>
        </div>
        <p>
          I built Contextsheet because manually copying data into spreadsheets
          from AI chat interfaces, especially when needing context from Drive
          documents, felt inefficient.
        </p>
        <p>
          This add-on aims to bridge that gap to connect Sheets, Drive, and
          various LLM APIs (Gemini, Claude via Anthropic/Bedrock, and OpenAI).
          It incorporates features like document ranking and context management
          to provide more relevant answers directly within the spreadsheet
          environment, kinda like RAGs.
        </p>
        <p>
          Privacy has been priority number one, with all user data kept in your
          own Google environment / LLM endpoints. No data is shared with third
          parties, nor is any data stored on my servers. Besides Google
          libraries, no other libraries are used outside the call for the LLM
          APIs chosen by the user.
        </p>
        <p>
          Some thoughts on the project as well:
          <br />
          The extension is no way near perfect, as both quota limits(if your on
          free tier like me) and document finding is a bit inconsintent (hence
          why i created all of the options). I'm also working on a PDF OCR
          feature, so that you can use scanned PDFs as context as well. All of
          this is coded without any libraries other than Google Apps Script,
          which enables a lot of privacy, but decreases the amount of
          opportunities for performance improvements (would have loved to
          incorporate stuff like Langchain or even just a vector DB).
        </p>

        <h2>Connect</h2>
        <p>Feel free to connect with me:</p>
        <ul class="connect-list">
          <li>
            <img src="images/linkedin.png" alt="LinkedIn Logo" class="icon" />
            <strong>LinkedIn:</strong>
            <a
              href="https://www.linkedin.com/in/albert-steenstrup-a733721b3/"
              target="_blank"
              rel="noopener noreferrer"
              >Albert Steenstrup</a
            >
          </li>
          <li>
            <img src="images/gmail.png" alt="Gmail Logo" class="icon" />
            <strong>Email:</strong>
            <a href="mailto:albert.steenstrup@contextsheet.com"
              >albert.steenstrup@contextsheet.com</a
            >
          </li>
        </ul>
      </section>
      <!-- START: Privacy Policy Content -->
      <!-- START: Privacy Policy Content -->
<section id="privacy-content" class="hidden">
  <h1>Privacy Policy for Contextsheet</h1>
  <p><strong>Effective Date:</strong> April 27, 2025</p> <!-- *** REPLACE DATE *** -->

  <h2>1. Introduction</h2>
  <p>
    Welcome to Contextsheet. This Privacy Policy explains how I collect, use, disclose, and safeguard your information
    when you use my Google Workspace Add-on, Contextsheet (the "Add-on"),
    within Google Sheets.
  </p>
  <p>
    The Add-on allows users to interact with Large Language Models (LLMs)
    like Google Gemini, Anthropic Claude, and OpenAI ChatGPT to get
    answers based on the context of selected cells in their Google Sheet
    and/or content from Google Drive files or folders they specify.
  </p>
  <p>
    Contextsheet is designed with privacy as a core principle. **Your Google Sheet data and Google Drive content accessed by the Add-on remain within Google's infrastructure and are only sent directly from Google's servers (where the Add-on script runs) to the specific third-party LLM API endpoint you select via the Add-on.** I do not operate any intermediate servers that process or store your core data.
  </p>
  <p>
    Please read this privacy policy carefully. If you do not agree with
    the terms of this privacy policy, please do not install or use the
    Add-on.
  </p>

  <h2>2. Information I Collect and Access</h2>
  <p>
    To provide its functionality, the Add-on needs to access or collect the following information, **all processed within your Google environment or sent directly to your chosen LLM:**
  </p>
  <ul>
    <li>
      <strong>Google Sheet Data (User-Initiated Access):</strong>
      <ul>
        <li>
          <strong>Cell Content:</strong> When you select cells in your
          Google Sheet and submit a query, the text content of those
          selected cells is accessed by the Add-on's backend script
          (Code.gs), **running on Google's servers.**
        </li>
        <li>
          <strong>Cell A1 Notation:</strong> The location (e.g., "A1",
          "B2:C5") of your selected cells is accessed to identify the
          source of the data and for potential insertion operations.
        </li>
      </ul>
    </li>
    <li>
      <strong>Google Drive Data (User-Initiated Access):</strong>
      <ul>
        <li>
          <strong>File/Folder Content:</strong> When you provide a Google
          Drive file or folder URL, the Add-on's backend script (**running on Google's servers**) accesses the content of the specified files
          (including files within the specified folder) to use as context
          for answering your queries. This may include text extraction
          from documents, spreadsheets, presentations, and PDFs
          (potentially using **Google's internal conversion services**).
        </li>
        <li>
          <strong>File Metadata:</strong> The Add-on accesses metadata
          (like file names, IDs, web links, modified times, mime types) of
          the specified Drive files/folders using **Google's APIs**.
        </li>
      </ul>
    </li>
    <li>
      <strong>User Configuration and Input:</strong>
      <ul>
        <li>
          <strong>Queries:</strong> The questions or prompts you type into
          the Add-on sidebar.
        </li>
        <li>
          <strong>API Keys:</strong> API keys you provide for third-party
          LLM services (Google Gemini, Anthropic Claude, OpenAI ChatGPT).
          These are required to interact with the respective services. **These keys are stored securely within your Google environment (UserProperties) and are never transmitted outside Google except when used to authenticate directly with the LLM provider's API.**
        </li>
        <li>
          <strong>Settings:</strong> Your chosen LLM preference, the
          provided Google Drive URL, toggle settings, and slider settings, **stored within your Google environment (UserProperties).**
        </li>
      </ul>
    </li>
    <li>
      <strong>Google Account Information (Implicit):</strong>
      <ul>
        <li>
          The Add-on operates under your Google Account's authority **within the Google Workspace environment.** I do
          not directly collect or store your name or email address. Access
          is controlled through Google's standard OAuth consent screen.
        </li>
      </ul>
    </li>
  </ul>

  <h2>3. How I Use Your Information</h2>
  <p>
    **All processing of your Sheet data and Drive content occurs within Google's Apps Script environment.** I use the information collected or accessed solely for the following purposes:
  </p>
  <ul>
    <li>
      <strong>To Provide Add-on Functionality:</strong> To construct
      prompts containing your query, selected Sheet data snippets, and/or
      relevant Drive content snippets to be sent **directly from Google's servers** to the selected
      third-party LLM API; To receive responses from the LLM API; To
      display the results within the Add-on sidebar; To insert the
      generated answers and optional notes back into your Google Sheet
      based on your instructions.
    </li>
    <li>
      <strong>To Store Your Configuration:</strong> To save your API keys
      securely using **Google Apps Script's UserProperties service (scoped
      only to you and the script within your Google environment)**; To store your preferences (LLM, Drive
      URL, settings) in UserProperties.
    </li>
    <li>
      <strong>To Authenticate API Calls:</strong> To use your provided API
      keys to make authenticated requests to third-party LLM services from
      the Add-on's backend script **(running on Google servers). Keys are never exposed client-side after saving.**
    </li>
    <li>
      <strong>To Improve the Add-on:</strong> I do not currently collect
      anonymized usage data beyond standard Google Cloud error logging for
      script execution issues **within Google's infrastructure.**
    </li>
  </ul>

  <h2>4. Third-Party Services and Data Sharing</h2>
  <p>
    To function, the Add-on interacts with the following services, **always initiating connections from within Google's infrastructure:**
  </p>
  <ul>
    <li>
      <strong>Google Cloud / Apps Script:</strong> The Add-on's backend
      code runs on Google's infrastructure.
    </li>
    <li>
      <strong>Google Drive API:</strong> Used to access file/folder
      metadata and content **within Google's ecosystem.**
    </li>
    <li>
      <strong>Google Workspace APIs (Sheets, Docs):</strong> Used to read selected cell data, insert results, and potentially convert files **within Google's ecosystem.**
    </li>
    <li>
      <strong>Large Language Model (LLM) Providers:** Crucially, data sent to LLMs travels **directly from Google's servers** (where the Add-on code runs) to the selected LLM provider's endpoint. **No data is routed through or stored on any servers controlled by me (the developer).** Based on your
      selection, prompts containing your query, selected sheet cell
      content snippets, and/or snippets of content from your specified
      Drive files are sent to one of the following services:
      <ul>
        <li>
          <strong>Google (Gemini Models):</strong>
          <a
            href="https://policies.google.com/privacy"
            target="_blank"
            rel="noopener noreferrer"
            >https://policies.google.com/privacy</a
          >
        </li>
        <li>
          <strong>Anthropic (Claude Models):</strong>
          <a
            href="https://www.anthropic.com/privacy"
            target="_blank"
            rel="noopener noreferrer"
            >https://www.anthropic.com/privacy</a
          >
        </li>
        <li>
          <strong>OpenAI (ChatGPT Models):</strong>
          <a
            href="https://openai.com/policies/privacy-policy"
            target="_blank"
            rel="noopener noreferrer"
            >https://openai.com/policies/privacy-policy</a
          >
        </li>
      </ul>
    </li>
  </ul>
  <p>
    <strong>Important:</strong> I send the minimum necessary information
    within the prompt required for the LLM to generate a relevant answer.
    I do <strong>not</strong> share your API keys with these LLM
    providers (they are used for authentication only). **I do not route your data through any intermediate servers.** Your interaction with these third-party LLM services is
    also subject to their respective privacy policies and terms of
    service. I encourage you to review them.
  </p>
  <p>
    Other than the interactions described above, I do not share your
    information with any other third parties. **Your data stays within Google's environment or goes directly to the LLM endpoint you select.**
  </p>

  <h2>5. API Key Handling and Security</h2>
  <ul>
    <li>
      <strong>Storage:</strong> Your API keys are stored using Google Apps
      Script's UserProperties service, specific to you and this script
      only, **residing securely within Google's infrastructure.**
    </li>
    <li>
      <strong>Usage:</strong> Keys are retrieved by the backend script
      (**running on Google servers**) only when needed to make authenticated API calls **directly to the LLM provider.** They are never
      stored client-side or sent back to the sidebar after saving.
    </li>
    <li>
      <strong>Security:</strong> The security of your stored keys depends
      on your Google Account security. Use strong passwords and 2FA.
    </li>
  </ul>

  <h2>6. Data Storage and Security</h2>
  <ul>
    <li>
      <strong>Configuration Data:</strong> Stored in UserProperties linked
      to your Google Account **within Google's environment.**
    </li>
    <li>
      <strong>Processing Data:</strong> Sheet/Drive content is processed
      transiently by the backend script **running entirely within Google's infrastructure** and is not permanently stored by
      the Add-on itself on any external servers. Snippets are sent directly to LLMs (see Section 4).
    </li>
    <li>
      <strong>Transmission:</strong> All communication between your browser and Google's Apps Script servers, and between Apps Script servers and third-party APIs, occurs over
      encrypted HTTPS.
    </li>
    <li>
      <strong>Infrastructure:</strong> The Add-on, including its backend script (`Code.gs`), runs entirely **within Google's secure Cloud infrastructure.** No external servers controlled by me are used for data processing or storage.
    </li>
  </ul>

  <h2>7. Data Retention</h2>
  <ul>
    <li>
      <strong>Configuration Data (API Keys, Settings):</strong> Retained
      in UserProperties (**within Google's environment**) while the Add-on is installed or until you clear
      them. I recommend clearing keys before uninstalling.
    </li>
    <li>
      <strong>Sheet/Drive Content:</strong> Processed transiently **on Google's servers**; not
      retained by the Add-on itself. Residual data may exist in Google execution logs or third-party LLM logs
      per their respective policies.
    </li>
  </ul>

  <h2>8. Your Choices and Rights</h2>
  <ul>
    <li>
      <strong>Accessing and Modifying Settings:</strong> Via the Add-on's
      interface.
    </li>
    <li>
      <strong>Managing API Keys:</strong> Add, view (masked), update,
      remove via the Add-on's interface.
    </li>
    <li>
      <strong>Revoking Access:</strong> Via your Google Account settings
      ([https://myaccount.google.com/permissions](https://myaccount.google.com/permissions)).
    </li>
    <li>
      <strong>Uninstalling:</strong> Via Google Sheets Extensions/Add-ons
      menu or the Marketplace.
    </li>
    <li><strong>Contacting me:</strong> See Section 11.</li>
  </ul>

  <h2>9. Children's Privacy</h2>
  <p>
    The Add-on is not intended for use by children under the age of 13 (or
    a higher age threshold applicable in your jurisdiction). I do not
    knowingly collect personal information from children under this age.
  </p>

  <h2>10. Changes to This Privacy Policy</h2>
  <p>
    I may update this Privacy Policy. I will notify you by posting the
    new policy. Changes are effective when posted. Continued use after
    changes constitutes acceptance.
  </p>

  <h2>11. Contact me</h2>
  <p>
    If you have any questions or concerns about this Privacy Policy,
    please contact me at:
  </p>
  <p><a href="mailto: ">albert.steenstrup@contextsheet.com</a></p>

</section>
<!-- END: Privacy Policy Content -->
      <!-- END: Privacy Policy Content -->
    </main>

    <footer>
      ¬© <span id="copyright-year"></span> Contextsheet | All rights reserved. |
      <a
        href="#"
        id="nav-privacy"
        onclick="showPage('privacy-content'); return false;"
        >Privacy Policy</a
      >
      <!-- Added this link with onclick -->
      <br />
      Google Sheets‚Ñ¢ and Google Drive‚Ñ¢ are trademarks of Google LLC. This site
      is not affiliated with or endorsed by Google.
    </footer>

    <script>
      // Simple SPA Logic (Mostly unchanged, removed slideshow parts)
      const pages = ["home-content", "about-content", "privacy-content"];
      const navLinks = document.querySelectorAll(".nav-link"); // Assuming class '.nav-link' is kept on nav items

      function showPage(pageIdToShow) {
        pages.forEach((pageId) => {
          const pageElement = document.getElementById(pageId);
          if (pageElement) {
            pageElement.classList.add("hidden");
          }
        });

        const targetPage = document.getElementById(pageIdToShow);
        if (targetPage) {
          targetPage.classList.remove("hidden");
        }

        // Update active nav link
        navLinks.forEach((link) => {
          link.classList.remove("active");
          // More robust check based on the target page ID
          if (link.id === `nav-${pageIdToShow.split("-")[0]}`) {
            link.classList.add("active");
          }
        });

        window.scrollTo(0, 0); // Scroll to top
      }

      // Set current year in footer
      const yearSpan = document.getElementById("copyright-year");
      if (yearSpan) {
        yearSpan.textContent = new Date().getFullYear();
      }

      // Initial setup: Show the home page by default
      document.addEventListener("DOMContentLoaded", () => {
        showPage("home-content");
        // Add any other initialization if needed
      });

      // Re-add event listeners for nav links if needed (or ensure onclick works)
      // Example:
      // document.getElementById('nav-home').addEventListener('click', (e) => { e.preventDefault(); showPage('home-content'); });
      // document.getElementById('nav-about').addEventListener('click', (e) => { e.preventDefault(); showPage('about-content'); });
      // The onclick attributes in the HTML should suffice here.

      // --- Media Carousel Logic (Now targets videos) ---
      const videoCarouselContainer = document.querySelector(
        ".video-carousel-container"
      );
      const videoTrack = videoCarouselContainer?.querySelector(".video-track");
      const videoCaption = document.querySelector(
        ".video-showcase .caption.video-caption"
      ); // Get the caption element
      const videoElements = videoCarouselContainer?.querySelectorAll(
        ".video-carousel-item"
      );
      let currentIndex = 0;

      if (videoCarouselContainer && videoTrack) {
        const items = videoTrack.querySelectorAll(".media-item"); // Select items within the track
        const prevBtn = videoCarouselContainer.querySelector(".prev-btn"); // Look within the container
        const nextBtn = videoCarouselContainer.querySelector(".next-btn"); // Look within the container

        // Function to show a specific video
        function showItem(index) {
          if (!items || items.length === 0) return;

          // Pause all videos
          items.forEach((item) => {
            const video = item.querySelector("video");
            if (video) {
              video.pause();
              video.currentTime = 0;
            }
          });

          // Remove active class from all items
          items.forEach((item) => item.classList.remove("active"));

          // Add active class to the target item
          items[index].classList.add("active");

          // Play the current video
          const currentVideo = items[index].querySelector("video");
          if (currentVideo) {
            // Ensure video is set to play
            currentVideo.autoplay = true;
            const playPromise = currentVideo.play();

            // Handle play promise to prevent errors
            if (playPromise !== undefined) {
              playPromise.catch((error) => {
                console.log("Autoplay was prevented:", error);
                // Add a play button or other fallback here if needed
              });
            }

            // Update the caption
            if (videoCaption) {
              videoCaption.textContent =
                currentVideo.dataset.caption || "Video";
            }
          }
        }

        function nextItem() {
          currentIndex = (currentIndex + 1) % items.length;
          showItem(currentIndex);
        }

        function prevItem() {
          currentIndex = (currentIndex - 1 + items.length) % items.length;
          showItem(currentIndex);
        }

        // Event Listeners for buttons
        if (prevBtn && items.length > 1) {
          prevBtn.addEventListener("click", prevItem);
        }

        if (nextBtn && items.length > 1) {
          nextBtn.addEventListener("click", nextItem);
        }

        // Add event listeners to videos to move to next when ended
        items.forEach((item, index) => {
          const video = item.querySelector("video");
          if (video) {
            video.addEventListener("ended", () => {
              // Move to next video when current one ends
              nextItem();
            });
          }
        });

        // Initialize
        showItem(currentIndex); // Show initial item
      }
      // --- End Video Carousel Logic ---

      // --- About Me Carousel Logic ---
      const aboutMeCarousel = document.querySelector(".about-me-carousel");
      if (aboutMeCarousel) {
        const aboutMeItems = aboutMeCarousel.querySelectorAll(".carousel-item");
        let aboutMeCurrentIndex = 0;
        const aboutMeInterval = 4000; // 4 seconds

        function showNextAboutMeItem() {
          aboutMeItems[aboutMeCurrentIndex].classList.remove("active");
          aboutMeCurrentIndex = (aboutMeCurrentIndex + 1) % aboutMeItems.length;
          aboutMeItems[aboutMeCurrentIndex].classList.add("active");
        }

        // Start the carousel if there are items
        if (aboutMeItems.length > 1) {
          setInterval(showNextAboutMeItem, aboutMeInterval);
        }
      }
      // --- End About Me Carousel Logic ---

      // Replace the existing onclick attribute in your About link with an event listener
      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("nav-home")
          .addEventListener("click", function (e) {
            e.preventDefault();
            showPage("home-content");
          });

        document
          .getElementById("nav-about")
          .addEventListener("click", function (e) {
            e.preventDefault();
            showPage("about-content");
          });
      });

      // Video Switching Logic
      document.addEventListener("DOMContentLoaded", function () {
        const mainVideo = document.getElementById("main-video");
        const videoSource = document.getElementById("video-source");
        const prevBtn = document.querySelector(".video-btn.prev-btn");
        const nextBtn = document.querySelector(".video-btn.next-btn");
        const videoCaption = document.querySelector(".video-caption");

        // Define videos and their captions
        const videos = [
          { src: "images/demo.mp4", caption: "Demo Video" },
          { src: "images/dpa.mp4", caption: "Use case 1: Data privacy" },
          { src: "images/hr.mp4", caption: "Use case 2: HR contracts" },
        ];

        let currentVideoIndex = 0;

        // Function to update video source and caption
        function updateVideo(index) {
          // Pause current video
          mainVideo.pause();

          // Update source
          videoSource.src = videos[index].src;

          // Update caption
          videoCaption.textContent = videos[index].caption;

          // Load and play new video
          mainVideo.load();
          mainVideo.play();
        }

        // Handle next button click
        nextBtn.addEventListener("click", function () {
          currentVideoIndex = (currentVideoIndex + 1) % videos.length;
          updateVideo(currentVideoIndex);
        });

        // Handle previous button click
        prevBtn.addEventListener("click", function () {
          currentVideoIndex =
            (currentVideoIndex - 1 + videos.length) % videos.length;
          updateVideo(currentVideoIndex);
        });

        // Handle video end - go to next video
        mainVideo.addEventListener("ended", function () {
          currentVideoIndex = (currentVideoIndex + 1) % videos.length;
          updateVideo(currentVideoIndex);
        });
      });
    </script>
  </body>
</html>
